ANSWERS:={};

G5:=GL(2,Integers(5));
G25:=GL(2,Integers(25));
G13:=GL(2,Integers(13));

Left:=5;
Right:=13;

GLeftRight:=GL(2,Integers(Left*Right));

KerLeft1:=[[1+Left*x,0,0,1] : x in [0..(1+Right)] | GCD(1+Left*x,Left*Right) eq 1];
KerLeft2:=[[1,0,0,1+Left*x] : x in [0..(1+Right)] | GCD(1+Left*x,Left*Right) eq 1];
KerLeft3:=[[1,Left,0,1],[1,0,Left,1]];

KerRight1:=[[1+Right*x,0,0,1] : x in [0..(1+Left)] | GCD(1+Right*x,Left*Right) eq 1];
KerRight2:=[[1,0,0,1+Right*x] : x in [0..(1+Left)] | GCD(1+Right*x,Left*Right) eq 1];
KerRight3:=[[1,Right,0,1],[1,0,Right,1]];

H51:=sub<G5|[2,1,0,3],[1,2,2,0],[1,1,0,2]>; /* 5.5.0.1, 5.5.0.a.1, MAXIMAL */
H52:=sub<G5|[2,0,0,3],[1,0,1,1],[1,0,0,2]>; /* 5.6.0.1, 5.6.0.a.1, MAXIMAL */
H53:=sub<G5|[3,1,0,2],[1,2,2,0],[2,2,2,1]>; /* 5.10.0.1, 5.10.0.a.1, MAXIMAL */
H54:=sub<G5|[4,0,1,4],[1,0,0,2]>; /* 5.12.0.2, 5.12.0.a.2 */
H55:=sub<G5|[4,0,1,4],[2,0,0,1]>; /* 5.12.0.1, 5.12.0.a.1 */
H56:=sub<G5|[2,1,0,3],[2,0,2,3],[1,0,2,2]>; /* 5.15.0.1, 5.15.0.a.1 */
H57:=sub<G5|[3,1,0,2],[2,1,0,1]>; /* 5.30.0.1, 5.30.0.a.1 */
H58:=sub<G5|[3,1,0,2],[2,1,3,3]>; /* 5.30.0.2, 5.30.0.b.1 */
H59:=sub<G5|[4,0,0,4],[2,0,0,1]>; /* 5.60.0.1, 5.60.0.a.1 */
H251:=sub<G25|[2,2,0,13],[4,1,3,1],[2,3,0,6]>; /* 25.30.0.1, 25.30.0.a.1 */
H252:=sub<G25|[9,10,0,14],[0,7,7,2],[2,8,0,1]>; /* 25.60.0.1, 25.60.0.a.1 */
H253:=sub<G25|[9,10,0,14],[0,7,7,2],[4,1,0,7]>; /* 25.60.0.2, 25.60.0.a.2 */

X51:=sub<GLeftRight|[2,1,0,3],[1,2,2,0],[1,1,0,2]>; /* 5.5.0.1, 5.5.0.a.1, MAXIMAL */
X52:=sub<GLeftRight|[2,0,0,3],[1,0,1,1],[1,0,0,2]>; /* 5.6.0.1, 5.6.0.a.1, MAXIMAL */
X53:=sub<GLeftRight|[3,1,0,2],[1,2,2,0],[2,2,2,1]>; /* 5.10.0.1, 5.10.0.a.1, MAXIMAL */
X54:=sub<GLeftRight|[4,0,1,4],[1,0,0,2]>; /* 5.12.0.2, 5.12.0.a.2 */
X55:=sub<GLeftRight|[4,0,1,4],[2,0,0,1]>; /* 5.12.0.1, 5.12.0.a.1 */
X56:=sub<GLeftRight|[2,1,0,3],[2,0,2,3],[1,0,2,2]>; /* 5.15.0.1, 5.15.0.a.1 */
X57:=sub<GLeftRight|[3,1,0,2],[2,1,0,1]>; /* 5.30.0.1, 5.30.0.a.1 */
X58:=sub<GLeftRight|[3,1,0,2],[2,1,3,3]>; /* 5.30.0.2, 5.30.0.b.1 */
X59:=sub<GLeftRight|[4,0,0,4],[2,0,0,1]>; /* 5.60.0.1, 5.60.0.a.1 */
X251:=sub<GLeftRight|[2,2,0,13+25],[4,1,3,1],[2,3,0,6]>; /* 25.30.0.1, 25.30.0.a.1 */
X252:=sub<GLeftRight|[9,10,0,14],[0,7,7,2],[2,8,0,1]>; /* 25.60.0.1, 25.60.0.a.1 */
X253:=sub<GLeftRight|[9,10,0,14],[0,7,7,2],[4,1,0,7]>; /* 25.60.0.2, 25.60.0.a.2 */

LeftGroups:=[X51,X52,X53];

H131:=sub<G13|[2,0,0,7],[1,0,1,1],[1,0,0,2]>; /* 13.14.0.1, 13.14.0.a.1 */
H132:=sub<G13|[3,0,0,9],[4,0,1,10],[1,0,0,2]>; /* 13.28.0.2, 13.28.0.a.2 */
H133:=sub<G13|[3,0,0,9],[4,0,1,10],[2,0,0,1]>; /* 13.28.0.1, 13.28.0.a.1 */
H134:=sub<G13|[5,0,0,8],[1,0,1,1],[1,0,0,2]>; /* 13.42.0.2, 13.42.0.a.1 */
H135:=sub<G13|[5,0,0,8],[1,0,1,1],[2,0,0,1]>; /* 13.42.0.1, 13.42.0.a.2 */
H136:=sub<G13|[5,0,0,8],[1,0,1,1],[2,0,0,3]>; /* 13.42.0.3, 13.42.0.b.1 */

X131:=sub<GLeftRight|[2,0,0,7],[1,0,1,1],[1,0,0,2]>; /* 13.14.0.1, 13.14.0.a.1 */
X132:=sub<GLeftRight|[3+13,0,0,9+13],[4,0,1,10+13],[1,0,0,2]>; /* 13.28.0.2, 13.28.0.a.2 */
X133:=sub<GLeftRight|[3+13,0,0,9+13],[4,0,1,10+13],[2,0,0,1]>; /* 13.28.0.1, 13.28.0.a.1 */
X134:=sub<GLeftRight|[5+13,0,0,8],[1,0,1,1],[1,0,0,2]>; /* 13.42.0.2, 13.42.0.a.1 */
X135:=sub<GLeftRight|[5+13,0,0,8],[1,0,1,1],[2,0,0,1]>; /* 13.42.0.1, 13.42.0.a.2 */
X136:=sub<GLeftRight|[5+13,0,0,8],[1,0,1,1],[2,0,0,3+13]>; /* 13.42.0.3, 13.42.0.b.1 */

RightGroups:=[X131];

Attach("/users/garenchiloyan/Desktop/ell-adic-galois-images-main/groups/gl2.m");
load "/users/garenchiloyan/Desktop/ell-adic-galois-images-main/groups/gl2data.m";

for i in [1..#LeftGroups] do
for j in [1..#RightGroups] do
print <#LeftGroups-i,#RightGroups-j>;
XLeft:=sub<GLeftRight|Generators(LeftGroups[i]),KerLeft1,KerLeft2,KerLeft3>;
XRight:=sub<GLeftRight|Generators(RightGroups[j]),KerRight1,KerRight2,KerRight3>;
X:=XLeft meet XRight;
if GLeftRight![-1,0,0,-1] in X then
g:=GL2Genus(X);
if g lt 2 then
ANSWERS:=ANSWERS join <GL2Label(LeftGroups[i]),GL2Label(RightGroups[j])>;
end if;
end if;
end for;
end for;

ANSWERS;

